<Window x:Class="ai.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ai"
        Icon="/icon.png"
        mc:Ignorable="d"
        Title="ChatGPT"
        Height="750"
        Width="800"
        WindowStartupLocation="CenterScreen"
        Background="#212121"
        Foreground="White"
>
    <Window.Resources>
        <local:MessageAlignmentConverter x:Key="messageAlignmentConverter" />
        <local:MessageIconVisibilityConverter x:Key="messageIconVisibilityConverter" />
        <local:MessageBackgroundColorConverter x:Key="messageBackgroundColorConverter" />
        <local:MessageListVisiblityConverter x:Key="messageListVisiblityConverter" />
        <local:TitleVisiblityConverter x:Key="titleVisiblityConverter" />

        <SolidColorBrush x:Key="buttonBackgroundBrush"
                         Color="White" />
        <SolidColorBrush x:Key="buttonPressedBackgroundBrush"
                         Color="White" />
        <SolidColorBrush x:Key="buttonForegroundBrush"
                         Color="#2C2C2C" />
        <SolidColorBrush x:Key="textBlockForegroundBrush"
                         Color="#9E9E9E" />

        <SolidColorBrush x:Key="textBoxBorderBrush"
                         Color="#9E9E9E" />

        <Style x:Key="myButtonStyle"
               TargetType="Button">
            <Setter Property="Background"
                    Value="{StaticResource buttonBackgroundBrush}" />
            <Setter Property="Foreground"
                    Value="{StaticResource buttonForegroundBrush}" />
            <Setter Property="FontSize"
                    Value="16" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="Height"
                    Value="25" />
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}"
                                CornerRadius="25"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
                            <ContentPresenter RecognizesAccessKey="True"
                                              Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsDefaulted"
                                     Value="true">
                            </Trigger>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                            </Trigger>
                            <Trigger Property="IsPressed"
                                     Value="true">
                                <Setter Property="Background"
                                        Value="{StaticResource buttonPressedBackgroundBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Opacity"
                                        Value="0.5" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>

                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="senderIconStyle"
       TargetType="Path">
            <Setter Property="Fill"
            Value="{StaticResource buttonBackgroundBrush}" />
        </Style>

        <Style x:Key="messageTextBoxStyle"
               TargetType="TextBox">
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Left" />
            <Setter Property="TextWrapping"
                    Value="Wrap" />
            <Setter Property="Padding"
                    Value="20" />
            <Setter Property="MinHeight"
                    Value="25" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <Border Name="border"
                                SnapsToDevicePixels="True">
                            <Grid Background="Transparent">
                                <ScrollViewer Margin="0"
                                              x:Name="PART_ContentHost"
                                              HorizontalScrollBarVisibility="Auto"
                                              VerticalScrollBarVisibility="Auto" />
                                <TextBlock x:Name="placeHolderTextBlock"
                                           Visibility="Collapsed"
                                           Text="Ask anything"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Foreground="#fff"
                                           Opacity="0.5"
                                           FontSize="16"
                                           Margin="21,0,0,0" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Text"
                                     Value="">
                                <Setter TargetName="placeHolderTextBlock"
                                        Property="Visibility"
                                        Value="Visible" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>




    <Border BorderBrush="Transparent"
            BorderThickness="1"
            Padding="0"
            Margin="10">
        <Grid Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- message/response -->
            <Grid Margin="0" MaxWidth="768" Visibility="{Binding messagesItemsControl.ItemsSource, Converter={StaticResource messageListVisiblityConverter}}">
                <Border>
                    <ScrollViewer x:Name="messagesScrollViewer"
                                  HorizontalScrollBarVisibility="Disabled"
                                  VerticalScrollBarVisibility="Hidden">
                        <ItemsControl x:Name="messagesItemsControl">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid HorizontalAlignment="{Binding IsRequest,Converter={StaticResource messageAlignmentConverter}}"
                                          Margin="10,10,10,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>


                                        <Border Background="{Binding IsRequest,Converter={StaticResource messageBackgroundColorConverter}}"
                                                CornerRadius="18"
                                                Padding="16,6"
                                                VerticalAlignment="Center"
                                                Grid.Column="1">
                                            <Grid>
                                                <TextBlock Text="{Binding Text}"
                                                           TextWrapping="Wrap"
                                                           FontSize="16"
                                                           Grid.Column="1" />
                                            </Grid>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
            </Grid>


            <Border Background="#303030"
                    CornerRadius="28"
                    Margin="10"
                    MaxWidth="768"
                    Grid.Row="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBox x:Name="messageTextBox"
                             AcceptsReturn="True"
                             AcceptsTab="False"
                             Foreground="#fff"
                             FontSize="16"
                             Style="{StaticResource messageTextBoxStyle}"
                             PreviewKeyDown="messageTextBox_PreviewKeyDown" TextChanged="messageTextBox_TextChanged" />

                    <Button x:Name="sendButton"
                            Width="35"
                            Height="35"
                            Margin="10,0,10,0"
                            Grid.Column="1"
                            Click="sendButton_Click">
                        <Button.Content>
                            <Viewbox Width="20" Height="20">
                                <Path 
                                    x:Name="sendIcon"
                                    Data="M8.99992 16V6.41407L5.70696 9.70704C5.31643 10.0976 4.68342 10.0976 4.29289 9.70704C3.90237 9.31652 3.90237 8.6835 4.29289 8.29298L9.29289 3.29298L9.36907 3.22462C9.76184 2.90427 10.3408 2.92686 10.707 3.29298L15.707 8.29298L15.7753 8.36915C16.0957 8.76192 16.0731 9.34092 15.707 9.70704C15.3408 10.0732 14.7618 10.0958 14.3691 9.7754L14.2929 9.70704L10.9999 6.41407V16C10.9999 16.5523 10.5522 17 9.99992 17C9.44764 17 8.99992 16.5523 8.99992 16Z"
                                    Fill="White"
                                    Width="20"
                                    Height="20"
                                >
                                    <Path.Style>
                                        <Style TargetType="Path" BasedOn="{StaticResource senderIconStyle}">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path=Text.Length, ElementName=messageTextBox}"
                                                 Value="1">
                                                    <Setter Property="Fill"
                                                Value="Black" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Path.Style>
                                </Path>
                            </Viewbox>
                        </Button.Content>
                        <Button.Style>
                            <Style TargetType="Button"
                                   BasedOn="{StaticResource myButtonStyle}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=Text.Length, ElementName=messageTextBox}"
                                                 Value="0">
                                        <Setter Property="Background"
                                                Value="#424242" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
